<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Mengalihkan…</title>
  <meta name="color-scheme" content="dark">
  <meta name="theme-color" content="#0b1220"/>

  <!-- Project Pages: isi "/<repo>"; User/Org Pages: "" -->
  <script>
    const BASE_PATH = "/shortlink";
  </script>

  <style>
    body{
      margin:0; height:100vh;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:#0b1220;
      color:#e5e7eb;
      text-align:center;
    }
    img.logo{
      width:180px; height:auto; margin-bottom:24px;
    }
    h1{
      font-size:20px; font-weight:500; letter-spacing:0.3px;
      margin:0;
    }
  </style>
</head>
<body>
  <img src="icons/logo.png" alt="Logo" class="logo"/>
  <h1>Mengalihkan…</h1>

  <script>
  (async function () {
    const BASE = (BASE_PATH || "");
    let slug = location.pathname;
    const base = BASE.replace(/\/+$/,"");
    if (base && slug.startsWith(base)) slug = slug.slice(base.length);
    slug = decodeURIComponent(slug)
              .replace(/^\/+|\/+$/g,"")
              .replace(/\/?index\.html$/i,"")
              .toLowerCase();

    if (!slug) { location.replace((BASE||"")+"/"); return; }

    const mapURL = (BASE||"") + "/links.json?ts=" + Date.now();
    async function loadMap(){
      const r = await fetch(mapURL,{cache:"no-store"});
      if(!r.ok) throw new Error();
      return r.json();
    }
    try{
      const links = await loadMap();
      const target = links[slug] || links[slug.replace(/\/+$/,"")] || null;
      if (target){
        const qs = location.search||"", hs = location.hash||"";
        location.replace(target + qs + hs);
      }
    }catch(e){
      // fallback: tetap di sini
    }
  })();
  </script>
</body>
</html>
