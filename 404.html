<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Mengalihkan…</title>
  <meta name="color-scheme" content="dark">
  <meta name="theme-color" content="#0b1220"/>

  <!-- Project Pages: isi "/<repo>"; User/Org Pages: "" -->
  <script>
    const BASE_PATH = "/shortlink";
  </script>

  <style>
    :root{
      --bg:#0b1220;
      --panel:#0f172a;
      --text:#e5e7eb;
      --border:rgba(255,255,255,.08);
      --radius:18px;
      --shadow:0 18px 50px rgba(0,0,0,.45);
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; display:grid; place-items:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: var(--bg);
      color:var(--text);
    }
    .card{
      width:min(400px, 90%);
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 30px 20px;
      text-align:center;
    }
    .card img{
      width:160px; height:auto; margin-bottom:20px;
    }
    h1{
      font-size:20px;
      font-weight:500;
      margin:0;
      letter-spacing:0.3px;
    }
  </style>
</head>
<body>
  <div class="card">
    <img src="icons/logo.png" alt="Logo"/>
    <h1>Mengalihkan…</h1>
  </div>

  <script>
  (async function () {
    const BASE = (BASE_PATH || "");
    let slug = location.pathname;
    const base = BASE.replace(/\/+$/,"");
    if (base && slug.startsWith(base)) slug = slug.slice(base.length);
    slug = decodeURIComponent(slug)
              .replace(/^\/+|\/+$/g,"")
              .replace(/\/?index\.html$/i,"")
              .toLowerCase();

    if (!slug) { location.replace((BASE||"")+"/"); return; }

    const mapURL = (BASE||"") + "/links.json?ts=" + Date.now();
    async function loadMap(){
      const r = await fetch(mapURL,{cache:"no-store"});
      if(!r.ok) throw new Error();
      return r.json();
    }
    try{
      const links = await loadMap();
      const target = links[slug] || links[slug.replace(/\/+$/,"")] || null;
      if (target){
        const qs = location.search||"", hs = location.hash||"";
        location.replace(target + qs + hs);
      }
    }catch(e){
      // fallback: tetap di sini (menampilkan card saja)
    }
  })();
  </script>
</body>
</html>
